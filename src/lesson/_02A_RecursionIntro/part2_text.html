<!DOCTYPE html>
<html>
<head>
  <title>Treść zadania</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <style type="text/css">
    body {
      font-size: 14px;
    }
    img {
      margin-right: 3px;
      float: left;
    }
    h2 {
      margin-top: 0px;
      margin-bottom: 0px;
      text-align: center;
    }
    div {
      margin-top: 15px;
      margin-bottom: 0px;
    }
    div.first {
      margin-top: 5px;
    }
    div.clear {
      margin-top: 0px;
      clear: both;
    }
  </style>
</head>

<body>
  <h2>Stos wywołań i rekord aktywacji</h2>
  <div class="first">
    W poprzedniej części pokazaliśmy podstawowy przykład rekurencji – funkcję silnia. 
    W tej części zapoznamy się z tym jak realizacja rekurencji jest wykonywana w pamięci komputera.
  </div>
  
  <div>
    <img src="instanceStack.png" alt="Nie można załadować obrazka"/>
    Analizując funkcję silnia pewnie zauważyłeś, iż program wywołując funkcję zatrzymywał się, 
    a w opisie programu wyświetlił się napis: „Połóż na stosie: silnia(10)”. 
    W tym momencie zapisują się informacje o nowej funkcji. Miejsce pamięci, 
    w którym te informacje są zapisywane, nazwane jest stosem wywołań. Zauważ, 
    że komputer może wykonywać na raz tyko jedną funkcję i wykonuje tylko tą, 
    która jest na szczycie (na wierzchu) stosu. W systemie rekurencja stos jest wizualizowany 
    w specjalnym oknie, którego obrazek widnieje po lewej stronie.
  </div>
  <div class="clear"></div>

  <div>
    <img src="instanceFrame.png" alt="Nie można załadować obrazka"/>
    W momencie wywoływania funkcji, na stosie zapamiętywane są wszystkie parametry wywołania, 
    a także zmienne lokalne (łącznie z lokalnymi tablicami) nowej funkcji.  
    Struktura, która jest zapamiętywana na stosie, nazywa się rekordem aktywacji. 
    W systemie rekurencja argumenty i zmienne lokalne poszczególnych wywołań funkcji (instancji funkcji) 
    można zobaczyć w specjalnym oknie „instancja funkcji”, którego obraz wyświetlony jest po lewej stronie.
  </div>
  <div class="clear"></div>

  <div>
    Kluczowy jest też moment zakończenia funkcji. Wówczas ze szczytu stosu usuwany 
    jest rekord aktywacji bieżącej funkcji, a następnie jest wykonywana funkcja, 
    której rekord znajdował się tuż pod spodem wierzchu stosu. Oczywiście komputer musi wiedzieć 
    do której linijki kodu ma powrócić po zakończeniu wywoływania funkcji, 
    dlatego w rekordzie aktywacji zapisywane jest także miejsce powrotu.
  </div>

  <div>
    <img src="instanceTree.png" alt="Nie można załadować obrazka"/>
    Wyżej powiedzieliśmy, że w momencie zakończenia funkcji ze stosu usuwany 
    jest rekord aktywacji  bieżącej funkcji. Zazwyczaj w pamięci komputera 
    taki rekord aktywacji jest kasowany i nie ma śladu, że taka funkcja została wywołana. 
    Jednak w systemie rekurencja usuwamy rekord aktywacji jedynie ze stosu. 
    Nie kasujemy go, w ten sposób możemy dokładnie prześledzić historię wywołań 
    poszczególnych funkcji. W specjalnym oknie, zwanym drzewie wywołań funkcji, 
    możemy przejrzeć, jakie funkcje zostały wywołane. 
    Obraz tego okna został wyświetlony po lewej stronie.
  </div>
  <div class="clear"></div>

  <div>
    W tej części funkcja silnia została odrobinę zmodyfikowana, 
    zostało dodanych kilka (niepotrzebnych) zmiennych lokalnych. 
    Uruchom funkcję silnia krok po kroku, a następnie gdy na stosie będzie już parę instancji, 
    kliknij prawym przyciskiem w niektóre z nich. Wówczas w oknie instancji funkcji 
    zostanie wyświetlona informacja o danej instancji. Zobacz, że zmienne lokalne, 
    a także tablice lokalne się od siebie różnią. Kiedy to zrobisz, przejdź do kolejnej części lekcji.
  </div>

</body>
</html> 